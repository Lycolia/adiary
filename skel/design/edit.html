<@6>
<@local(s,tp,t)>
<$s = v.blog>
<$ifredirect(!v.blog_admin, v.myself)>
<$v.frame_skeleton=''>
<@><!--========================================================================-->
<!DOCTYPE html>
<html lang="ja">
<head>
<@call('_sub/frame_head')>
<script src="<@Basepath><@v.script_dir>design-edit.js"></script>

	<title>デザイン編集 - <@s.blog_name></title>
<!--========================================================================-->
<style>
* {
	margin:		0;
	padding:	0;
}
html, #body {
	height:		100%;
	overflow:	hidden;
<@ifexec(!Develop, begin)>
	overflow:	hidden;
<$end>
}
#body {
	background-color:	#008;
	font-size:		11pt;
}
#right-buttons {
	position:		absolute;
	right:			4px;
}
#right-buttons button {
	margin:			1px;
}
#form {
	color:			#fff;
	margin:			2px 4px;
}
#form button + button {
	margin:			inherit;
}
button {
	padding:		0 3px;
}
select {
	padding:		0px 1px;
}
#iframe {
	width:			100%;
	min-height:		0;
	overflow-x:		hidden;
	overflow-y:		scrollbar;
	border:			none;
	background-color:	#fff;

	position:		absolute;
	left:			0px;
}
</style>
</head>
<body id="body">
<!--========================================================================-->
<$mods = v.load_modules_info()>
<$mods = sort_str(mods, 'title')>

<form id="form">
デザイン編集
<select name="modules" id="add-module">
<option value="">（追加モジュール選択）</option>
<@forexec(t, mods, begin)>
<option value="<@t.name>"><@t.title></option>
<$end>
</select>

<button id="save-btn" type="button">保存</button>
<button id="back-btn" type="button" onclick="window.location='<@v.myself>?<@v.skel_dir>'">戻る</button>
</form>
<iframe id="iframe" src="<@v.myself>"></iframe>

<!-- デザインモジュールの情報 =============================================-->
<div id="design-modules-data" style="display: none">
<@forexec(t, mods, begin)>
<$ifnext(t.adiary_version > v.VERSION)> <@>  対応Versionチェック
<div class="<@t.module_class>" title="<@t.title>"
 data-module-name="<@t.name>"
 data-type="<@t.module_type>"
 data-id="<@t.module_id>"
 data-setting="<@t.module_setting>"
 data-load-module-html="<@t.load_module_html_in_edit>"
 data-readme="<@if(t.readme,1)>"
 data-readme-url="<@Myself>?set2/plugin_readme&amp;name=<@t.name>"
 data-readme-title="<@t.name>のREADME"
>
<@t.sample_html>
</div>
<$end>


<!-- フォーム -->
<form action="<@v.myself>?<@v.skeleton>" method="POST" id="js-form">
<input type="hidden" name="action" value="<@v.skeleton>">
<input type="hidden" name="csrf_check_key" value="<@CSRF_check_key>">
</form>

<!-- モジュール設定画面用フォーム -->
<form method="POST" id="setting-form"
 data-setting-url="<@v.myself>?set2/plugin_setting&amp;name=">
<input type="hidden" name="action" value="set2/plugin_setting">
<input type="hidden" name="csrf_check_key" value="<@CSRF_check_key>">
</form>

<!-- モジュールHTMLロード用フォーム -->
<form method="POST" id="load-module-html-form">
<input type="hidden" name="action" value="design/load_module">
<input type="hidden" name="csrf_check_key" value="<@CSRF_check_key>">
<input type="hidden" name="module_name" id="js-load-module-name">
</form>
</div>


<@call('_sub/ajax_messages')>
<div style="display:none">
<span id="msg-delete-confirm">「%n」を削除しますか？</span>
<span id="msg-duplicate-id">「%n」は既に存在します（１つしか追加できません）</span>
</div>

<@call('_sub/frame_end')>

</body>
</html>
