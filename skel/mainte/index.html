<@7>
<@local(s,err)>
<$err=FormError>

<@> システムモード
<$v.system_mode("ブログの再構築")>

<!--=========================================================================-->
<@> 階層ツリー、権限確認、エラー表示
<@call("_sub/menu_tree")>

<!--=========================================================================-->
<article class="system setting">
<h2><@v.title></h2>
<div class="body">
	<p>ブログの全記事データを再構築します。</p>

	<p>記法の設定を変更した際などにご利用ください。環境と記事数によりますが、処理には時間がかかります。</p>

	<table>
	<tbody>
	<tr><th>ブログID</th>  <td><@v.blogid></td></tr>
	<tr><th>ブログ名</th>  <td><@v.blog.blog_name></td></tr>
	<tr><th>ブログ紹介</th><td><@v.blog.description_txt></td></tr>
	<tr><th>公開記事</th>  <td><@v.blog.arts || 0>件</td>
	<tr><th>非公開記事</th><td><@v.blog.darts || 0>件</td>
	</tbody>
	</table>

	<form action="<@v.myself>?<@v.skeleton>" method="POST">
	<input type="hidden" name="action" value="<@v.skel_dir>blog_rebuild">

	<p><label><input type="checkbox" name="only_blog_info" value="1" id="info-only" data-on="付加情報のみ再生成する" data-off="ブログを再構築する">付加情報（タグ一覧等）やRSSのみ再生成する</label></p>

	<button type="submit" id="submit-btn">ブログを再構築する</button><br>

	</form>
</div>
</article>


<script-defer><!--
	var info = $('#info-only');
	var submit = $('#submit-btn');
	info.change(function(evt){
		if (info.prop('checked'))
			submit.text( info.data('on') );
		else	submit.text( info.data('off') );
	});
	info.change();
--></script-defer>

