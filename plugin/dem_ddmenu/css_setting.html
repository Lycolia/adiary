<@7>
<@local(ps,name,id)>
<$ps=argv#0>
<$name=argv#1>
<$id  = v.plugin_name_id( name )>

	<div>
		<label><input class="js-switch" type="radio" name="view" data-target="#set-size"  checked>位置・サイズ</label>
		<label><input class="js-switch" type="radio" name="view" data-target="#set-color">色</label>
	</div>
<div id="set-size">
	<table class="blog-setting">
	<tbody>
	<tr>
		<th>表示位置<span class="help" data-help="メニューアイテム全体を左寄せで表示するか設定します。">?</span></th>
		<td>
			<label><input type="checkbox" name="no_centering" value="1"<@if(ps.no_centering,' checked')>>センタリングしない（左寄せで表示）</label><br>
			<label><input type="checkbox" name="item_left" value="1"<@if(ps.item_left,' checked')>>各項目を左寄せで表示する</label>
		</td>
	</tr>

	<tr>
		<th>項目幅</th>
		<td>
			1段目<input type="number" class="int w60" name="width1" value="<@ps.width1 || 110>" min="40" max="9999" id="width1">px &ensp;
			<label><input type="checkbox" name="width1_free" value="1"<@if(ps.width1_free, ' checked')> id="width1-free" class="js-disable" data-target="#width1">フリーサイズ<span class="help" data-help="項目内容に応じてアイテム幅を可変させます。設定時は各項目のpaddingも設定してください。">?</span></label><br>
			2段目以降<input type="number" class="int w60" name="width2" value="<@ps.width2 || 200>" min="40" max="9999" id="width2">px &ensp;
			<label><input type="checkbox" class="js-disable" data-target="#width1,#width1-free,#width2"<@if(ps.width2 eq '',' checked')>>変更しない</label>
		</td>
	</tr>
	<tr>
		<th>アイテムの高さ</th>
		<td>
			<input type="number" class="int w60" name="height" value="<@ps.height || 30>" min="20" max="99" id="height">px &ensp;
			<label><input type="checkbox" class="js-disable" data-target="#height"<@if(ps.height eq '',' checked')>>変更しない</label>
		</td>
	</tr>
	<tr>
		<th>枠線の非表示</th>
		<td>
			<label><input type="checkbox" name="nob_left"  value="1"<@if(ps.nob_left, ' checked')>>一番左</label> 
			<label><input type="checkbox" name="nob_right" value="1"<@if(ps.nob_right,' checked')>>一番右</label> 
			<label><input type="checkbox" name="nob_tb"    value="1"<@if(ps.nob_tb,   ' checked')>>上下</label> 
			<label><input type="checkbox" name="nob_lr"    value="1"<@if(ps.nob_lr,   ' checked')>>左右</label> 
		</td>
	</tr>
	<tr>
		<th>トップの表示</th>
		<td>
			<label><input type="checkbox" name="vbottom" value="1"<@if(ps.vbottom,' checked')>>文字位置を下にする</label>
		</td>
	</tr>
	<tr>
		<th>全体の左右余白</th>
		<td>
			<input type="number" class="int w60" name="padding" value="<@ps.padding || 0>" min="0" max="999" id="padding">px &ensp;
			<label><input type="checkbox" class="js-disable" data-target="#padding"<@if(ps.padding eq '',' checked')>>変更しない</label>
		</td>
	</tr>
	<tr>
		<th>項目の左右余白</th>
		<td>
			<input type="number" class="int w60" name="item_padding" value="<@ps.item_padding || 0>" min="0" max="999" id="item-padding">px &ensp;
			<label><input type="checkbox" class="js-disable" data-target="#item-padding"<@if(ps.item_padding eq '',' checked')>>変更しない</label>
		</td>
	</tr>
	<tr>
		<th>マージン<span class="help" data-help="表示位置はこの項目（特に「上」と「左」）で変更してください。">?</span></th>
		<td>
			上<input type="number" class="int w50" name="margin0" value="<@ps.margin0 || 0>" min="-999" max="999" id="margin0"> 
			右<input type="number" class="int w50" name="margin1" value="<@ps.margin1 || 0>" min="-999" max="999" id="margin1"> 
			下<input type="number" class="int w50" name="margin2" value="<@ps.margin2 || 0>" min="-999" max="999" id="margin2"> 
			左<input type="number" class="int w50" name="margin3" value="<@ps.margin3 || 0>" min="-999" max="999" id="margin3"> &ensp;
			<label><input type="checkbox" class="js-disable" data-target="#margin0,#margin1,#margin2,#margin3"<@if(ps.margin0 eq '',' checked')>>変更しない</label>
		</td>
	</tr>
	<tr>
		<th>表示優先度<span class="help" data-help="表示優先度(z-index)を変更します。複数のドロップダウンメニューを配置するときのみ変更してください。">?</span></th>
		<td>
			<input type="number" class="int w80" name="zindex" value="<@ps.zindex || 950>" min="900" max="999" id="zindex"> &ensp;
			<label><input type="checkbox" class="js-disable" data-target="#zindex"<@if(ps.zindex eq '',' checked')>>変更しない</label>
		</td>
	</tr>
	</tbody>
	</table>
</div>

<div id="set-color">
	<table class="blog-setting">
	<tbody>
	<tr>
		<th>全体の背景<span class="help" data-help="メニューアイテムを除いた部分の背景の設定です。">?</span></th><td>
			<label><input type="checkbox" name="bg_trans" value="1"<@if(ps.bg_trans,' checked')>>透過にする</label>
		</td>
	</tr>
	<tr>
		<th>トップの背景<span class="help" data-help="トップアイテムの背景色のみ透過にすることができます。使用する場合は「選択中の背景」を設定することを推奨します。">?</span></th><td>
			<label><input type="checkbox" class="js-enable" name="tbg_trans" value="1"<@if(ps.tbg_trans,' checked')>>透過にする</label>
		</td>
	</tr>
	<tr>
		<th>背景色</th><td>
			<input type="text" id="item-bg" name="item_bg" value="<@ps.item_bg || '#ccccff'>" class="color-picker">
			<label><input type="checkbox" class="js-disable" data-target="#item-bg"<@if(ps.item_bg eq '',' checked')>>変更しない</label>
		</td>
	</tr>
	<tr>
		<th>選択中の背景</th><td>
			<input type="text" id="select-bg" name="select_bg" value="<@ps.select_bg || '#f0f0ff'>" class="color-picker">

			<label><input type="checkbox" class="js-disable" data-target="#select-bg"<@if(ps.select_bg eq '',' checked')>>変更しない</label>
		</td>
	</tr>
	<tr>
		<th>枠線の色</th><td>
			<input type="text" id="border" name="border" value="<@ps.border || '#aaaadd'>" class="color-picker">

			<label><input type="checkbox" class="js-disable" data-target="#border"<@if(ps.border eq '',' checked')>>変更しない</label>
		</td>
	</tr>
	<tr>
		<th>矢印の色<span class="help" data-help="3階層目のメニューがあるときに表示される矢印の色を指定します。">?</span></th><td>
			<input type="text" id="arrow" name="arrow" value="<@ps.arrow || '#333366'>" class="color-picker">

			<label><input type="checkbox" class="js-disable" data-target="#arrow"<@if(ps.arrow eq '',' checked')>>変更しない</label>
		</td>
	</tr>
	<tr>
		<th>文字色</th><td>
			<input type="text" id="font" name="font" value="<@ps.font || '#3333cc'>" class="color-picker">

			<label><input type="checkbox" class="js-disable" data-target="#font"<@if(ps.font eq '',' checked')>>変更しない</label>
		</td>
	</tr>
	<tr>
		<th>影を消す<span class="help" data-help="影が表示されるテーマのみ有効です。">?</span></th><td>
			<label><input type="checkbox" name="no_shadow" value="1"<@if(ps.no_shadow,' checked')>>影を消す</label>
		</td>
	</tr>
	</tbody>
	</table>
</div>

<!-- JavaScript ==========================================================-->
<script>
$(function(){

// 設定中のモジュールを探し、デフォルト値を設定する
var obj = $f('#<@id>');
if (!obj.length) return;
var li  = obj.find('>ul>li:first-child');
var li2 = obj.find('ul>li>ul>li');

if ('<@ps.width1>' == '') {
	if (li.length)
		$('#width1').val( li.outerWidth() );
}
if ('<@ps.width2>' == '') {
	if (li2.length)
		$('#width2').val( li2.outerWidth() );
}
if ('<@ps.height>' == '') {
	$('#height').val( obj.outerHeight() );
}
if ('<@ps.zindex>' == '') {
	$('#zindex').val( obj.css('z-index') || 990 );
}
if (!<@ps.no_underl || 0>) {
	var a = li.find('a');
	if (li.height() == a.height()) $('#no-underl').prop('checked', true);
}


// マージンとpadding
if ('<@ps.margin0>' == '')
	$('#margin0').val( parse_px( obj.css('margin-top') ) );
if ('<@ps.margin1>' == '')
	$('#margin1').val( parse_px( obj.css('margin-right') ) );
if ('<@ps.margin2>' == '')
	$('#margin2').val( parse_px( obj.css('margin-bottom') ) );
if ('<@ps.margin3>' == '')
	$('#margin3').val( parse_px( obj.css('margin-left') ) );

if ('<@ps.padding>' == '') {
	var ul = obj.find('>ul').first();
	$('#padding').val( parse_px( ul.css('padding-left') ) );
}
if ('<@ps.item_padding>' == '') {
	var a = obj.find('>ul>li>a').first();
	$('#item-padding').val( parse_px( a.css('padding-left') ) );
}


if ('<@ps.item_bg>' == '' && li.length) {
	var col = parse_color(li.css('background-color'));
	if (col) $('#item-bg').val(col);
}
if ('<@ps.border>' == '' && li.length) {
	var col = get_border_color(li)
	col = parse_color( col );
	if (col) $('#border').val(col);
}
if ('<@ps.font>' == '' && li.length) {
	var a = li.find('a:first-child');
	var col = parse_color(a.css('color'));
	if (col) $('#font').val(col);
}
if ('<@ps.arrow>' == '' && li.length) {
	var col = parse_color(obj.css('color'));
	if (col) $('#arrow').val(col);
}

// 最後に処理
if ('<@ps.select_bg>' == '' && li.length) {
	li.addClass('hover');
	delay_color_setting('#select-bg', li, 'background-color', 'hover');
}
//=============================================================================
});
</script>
