------------------------------------------------------------------------------
■link_keyルール
------------------------------------------------------------------------------
-予約文字は「/ < > " ' % ? & #」と \x00-\x1F の文字。
-予約文字は _ に置換される。
-TABは空白に置換される。

------------------------------------------------------------------------------
■URLルール
------------------------------------------------------------------------------
adiary.cgi/linkkey	linkkey の記事を表示
adiary.cgi/0\d+		記事pkey指定（link_keyと同じ処理）
adiary.cgi/\d+		日付指定
adiary.cgi/?xxx		スケルトン=xxx
adiary.cgi/?xxx&...	スケルトン=xxx / query指定
adiary.cgi/?..&sk=xxx&.	スケルトン=xxx / query指定
adiary.cgi/?&...	ディフォルトスケルトンに対するquery指定

------------------------------------------------------------------------------
■重要内部変数
------------------------------------------------------------------------------
v.myself	Queryや素リンク用URL
v.myself2	PATH_INFOリンク用URL
v.myself3	ログインしているユーザーブログURL

v.blogid	現在の blog の id。この文字列が空でないかでブログ存在ができる
v.blog		現在の blog の情報(hash)。ブログが存在しなくてもhashが存在することがある。

------------------------------------------------------------------------------
■DB情報
------------------------------------------------------------------------------
●xxx_art
------------------------------------------------------------------------------
pkey		serial
title		text			# 記事タイトル
text		ltext			# 記事データ
text_s		ltext			# 短い記事データ。「続き」が存在しないときは空
_text		ltext			# 元データ
parser		text			# パーサー名

tags		text			# [cache] タグのデータ(","で分割)
name		text			# 投稿者名
id		text			# 投稿者ID

ip		text			# IPアドレス
host		text			# ホスト名
agent		text			# Agent名

yyyymmdd	int  NOT NULL		# 記事の日付
tm		int			# 書き込み日時
update_tm	int			# 更新日時

coms		int  NOT NULL		# コメント数
coms_all	int  NOT NULL		# コメント数（非公開含む）

enable		flag NOT NULL		# 記事の公開
com_ok		flag NOT NULL		# コメント許可
hcom_ok		flag NOT NULL		# 非公開コメント許可
revision	int			# リビジョン管理する

### 構造関係 ###
link_key	text UNIQUE NOT NULL	# リンク用文字列（非escape）。"/"階層付
ctype		text			# コンテンツの種別。''=通常記事, 'wiki'=wiki
upnode		int			# 親記事のpkey
priority	int			# コンテンツ表示順設定（1以上）。通常記事は常に"0"

------------------------------------------------------------------------------
●xxx_tag
------------------------------------------------------------------------------
pkey		serial
name		text NOT NULL UNIQUE			# タグ名
qt		int  NOT NULL				# カウント（記事数）
upnode		int  ref(xxx_tag.pkey)			# 親カテゴリ
priority	int  NOT NULL				# 表示順

------------------------------------------------------------------------------
●xxx_tagart
------------------------------------------------------------------------------
pkey		serial
t_pkey		int  NOT NULL ref(xxx_tag.pkey)		# タグpkey
a_pkey		int  NOT NULL ref(xxx_art.pkey)		# 記事pkey
a_enable	flag NOT NULL				# [cache] 記事公開フラグ
------------------------------------------------------------------------------
●xxx_log
------------------------------------------------------------------------------
pkey		serial

title		text					# 記事タイトル
text		ltext					# 記事データ
_text		ltext					# 元データ
parser		text					# パーサー
note		text					# 注釈、コメント

name		text					# このリビジョンの投稿者名
id		text					# このリビジョンの投稿者ID
ip		text					# IPアドレス
host		text					# ホスト名
agent		text					# Agent名

tm		int  NOT NULL				# 書き込み日時
a_pkey		int  NOT NULL ref(xxx_art.pkey)		# 変更ログ対象の記事
elock		flag NOT NULL				# ロックフラグ

------------------------------------------------------------------------------
●xxx_com
------------------------------------------------------------------------------
pkey		serial

text		text NOT NULL				# 本文
email		text					# メールアドレス
url		text					# URL

name		text					# 投稿者名
id		text					# 投稿者ID
tm		int  NOT NULL				# 投稿時刻

ip		text					# IPアドレス
host		text					# ホスト名
agent		text					# Agent名

a_pkey		int  NOT NULL ref(xxx_art.pkey)		# コメントした記事のpkey
a_yyyymmdd	int  NOT NULL				# [cache] 記事のyyyymmdd
a_title		text 					# [cache] 記事のタイトル
a_elink_key	text					# [cache] 記事のlink_key(URIエンコード済)

enable		flag NOT NULL				# 表示フラグ
hidden		flag NOT NULL				# 非公開コメントフラグ
